# **************************************************************************** #
#                                                                              #
#                                                         :::      ::::::::    #
#    Makefile                                           :+:      :+:    :+:    #
#                                                     +:+ +:+         +:+      #
#    By: baelgadi <baelgadi@student.42.fr>          +#+  +:+       +#+         #
#                                                 +#+#+#+#+#+   +#+            #
#    Created: 2025/12/14 20:25:16 by baelgadi          #+#    #+#              #
#    Updated: 2026/02/12 23:18:01 by baelgadi         ###   ########.fr        #
#                                                                              #
# **************************************************************************** #

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
#             ๐จ COLORS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

RESET = \033[0m
RED = \033[31m
GREEN = \033[32m
YELLOW = \033[33m
BLUE = \033[34m
MAGENTA = \033[35m
CYAN = \033[36m
GRAY = \033[90m
UNDERLINE = \033[4m

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
#         ๐๏ธ CONFIGURATION
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

NAME		= philo

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
#             ๐ FILES
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

SRC_DIR		= src
INC_DIR		= include

SRCS		= $(SRC_DIR)/main.c \
			  $(SRC_DIR)/parse.c \
			  $(SRC_DIR)/init.c \
			  $(SRC_DIR)/init_philo.c \
			  $(SRC_DIR)/sim.c \
			  $(SRC_DIR)/routine.c \
			  $(SRC_DIR)/actions.c \
			  $(SRC_DIR)/monitor.c \
			  $(SRC_DIR)/time.c \
			  $(SRC_DIR)/utils.c \
			  $(SRC_DIR)/accessors.c \
			  $(SRC_DIR)/cleanup.c

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
#      ๐ง SETUP & DEPENDENCIES
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

OBJS = ${SRCS:.c=.o}

DEPS =  $(OBJS:.o=.d)

CC		= cc
CFLAGS	= -Wall -Wextra -Werror -pthread -I $(INC_DIR)

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
#            ๐ฏ TARGETS
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

all: $(NAME)

$(NAME):	$(OBJS)
	@$(CC) $(CFLAGS) $^ -o $@ && printf "$(GREEN)โ $@ created\n" || printf "$(RED) โ $@\n"

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
#        ๐ฝ COMPILATION RULES
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

.c.o:
	@printf "Compiling $(BLUE)%-35s$(RESET)" $<
	@$(CC) $(CFLAGS) -c $< -o $@ && printf "โ\n" || printf "โ\n"

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
#            ๐งน CLEANING
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

clean:
	@rm -f $(OBJS) $(OBJS:.o=.d)
	@echo "$(YELLOW)๐งน Objects and dependencies deleted (clean)$(RESET)"

fclean: clean
	@rm -f $(NAME)
	@echo "$(RED)โ $(NAME) removed (fclean)$(RESET)"

re:	fclean all

# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
#         ๐ HELP & FOOTER
# โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

help:
	@echo "$(BLUE)Available targets:$(RESET)"
	@echo "$(YELLOW)all      $(RESET)โ Build philosophers (mandatory)"
	@echo "$(YELLOW)clean    $(RESET)โ Delete .o and .d files"
	@echo "$(YELLOW)fclean   $(RESET)โ Full clean"
	@echo "$(YELLOW)re       $(RESET)โ fclean + all"

-include $(DEPS)

.PHONY: all clean fclean re
